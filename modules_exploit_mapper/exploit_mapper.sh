#!/bin/bash
echo "ðŸ§  Exploit Mapper & PoC Suggestion Engine"
echo "Scanning for known CVEs and suggesting potential exploits..."

mkdir -p exploit_suggestions

if [[ ! -f nuclei_results.txt ]]; then
  echo "Missing nuclei_results.txt. Please run vulnerability scan first."
  exit 1
fi

# Extract CVEs
grep -o 'CVE-[0-9]\{4\}-[0-9]\{4,7\}' nuclei_results.txt | sort -u > exploit_suggestions/cves_found.txt

echo "Found CVEs:"
cat exploit_suggestions/cves_found.txt
echo ""

# Simulated PoC Suggestion (extend with searchsploit or online mapping)
while read -r cve; do
  echo "Searching for PoCs for $cve..."
  echo "â†’ Suggested exploit: $cve-exploit-example.sh" >> exploit_suggestions/poc_matches.txt
done < exploit_suggestions/cves_found.txt

echo ""
echo "PoC suggestions saved to exploit_suggestions/poc_matches.txt"
